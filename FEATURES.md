# M3U8 链接监控器 - 历史记录功能

## 新增功能

### 🔄 持久化历史记录
- **永久存储**：所有捕获的M3U8链接都会保存到浏览器本地存储
- **重启保持**：浏览器重启、插件重启都不会丢失历史记录
- **自动恢复**：插件启动时自动加载历史记录

### 🗑️ 灵活删除功能
- **单个删除**：每个链接项目都有"删除"按钮，可以删除不需要的记录
- **全部清空**：点击"清空历史"按钮可以删除所有历史记录
- **确认提示**：删除操作都有确认提示，防止误操作

### 🔍 智能URL显示
- **自动缩短**：默认只显示不包含查询参数的主要URL部分
- **点击展开**：点击链接或"展开"按钮可以查看完整URL
- **随时折叠**：点击"折叠"按钮恢复缩短显示
- **视觉提示**：可展开的链接有明显的展开按钮和悬停效果

### 🔍 完整请求信息记录
- **请求头收集**：自动收集Referer、Origin、User-Agent、Cookies等关键信息
- **响应头收集**：记录Content-Type、Cache-Control等响应头信息
- **页面上下文**：记录页面URL、标题、引用页面等信息
- **网络信息**：IP地址、缓存状态、HTTP状态码等
- **下载上下文**：为后续下载提供完整的浏览器环境模拟信息

### 📊 改进的界面显示
- **历史计数**：显示"历史记录 X 个 M3U8 链接"
- **状态图标**：✅ 表示已验证链接，⚠️ 表示未验证链接
- **详细信息**：显示域名、捕获时间、来源等信息

## 使用方法

1. **查看历史**：打开插件即可看到所有历史记录（包含完整请求信息）
2. **展开链接**：点击长链接或"展开"按钮查看完整URL
3. **折叠链接**：点击"折叠"按钮恢复缩短显示
4. **删除单个**：点击某个链接下方的红色"删除"按钮
5. **清空全部**：点击顶部的"清空历史"按钮
6. **过滤查看**：使用过滤选项查看特定类型的链接
7. **导出完整信息**：使用"导出"按钮获取包含所有请求头、响应头和上下文的JSON文件
8. **保存为文本**：使用"保存为TXT"功能获取包含关键信息的文本文件

## 存储机制

- 使用Chrome扩展的 `chrome.storage.local` API
- 数据存储在用户本地，不会上传到任何服务器
- 存储空间限制：Chrome扩展本地存储上限约10MB
- 数据持久性：除非用户主动清除浏览器数据，否则永久保存

## 安全说明

- 所有数据仅存储在本地浏览器
- 不收集或上传任何个人信息
- 开源代码，可自行审查安全性